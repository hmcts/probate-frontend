{% extends "includes/layout.html" %}

{% from "govuk/components/table/macro.njk" import govukTable %}

{% block content %}
    {% set applicationRows = [] %}
    {% for application in fields.applications.value %}
        {% if application.status == content.statusInProgress %}
            {% set actionUrl = "/task-list" %}
            {% set actionText = content.actionContinue %}
        {% else %}
            {% set actionUrl = "/thank-you" %}
            {% set actionText = content.actionView %}
        {% endif %}

        {% set applicationRows = (applicationRows.push([
            { text: application.deceasedFullName },
            { text: application.dateCreated},
            { text: application.status },
            { text: ("<a href=\"" + actionUrl + "\" class=\"govuk-link\">" + actionText + "</a>") | safe  }
        ]), applicationRows) %}
    {% endfor %}

    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <h1 class="govuk-heading-l">{{ content.header }}</h1>

            {{ govukTable({
                caption: content.header | safe,
                captionClasses: "govuk-visually-hidden",
                head: [
                    { text: content.tableHeader1 },
                    { text: content.tableHeader2 },
                    { text: content.tableHeader3 },
                    ""
                ],
                rows: applicationRows
            }) }}

            <p class="govuk-body"><a href="/start-eligibility" class="govuk-link">{{ content.actionStartNewApplication }}</a></p>
        </div>
    </div>

{#
    <p class="govuk-body"><a href="/task-list" class="govuk-link">{{ content.paragraph11 }}</a></p>
#}
{% endblock %}
